{
  "feature": "ì‚¬ìš©ì ë¯¸ë°œê²¬ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸",
  "description": "API ì‘ë‹µì—ì„œ 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤' ì—ëŸ¬ ë°œìƒ ì‹œ ìë™ìœ¼ë¡œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™",

  "trigger_condition": {
    "response": {
      "success": false,
      "message": "ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
    },
    "possible_status_codes": [401, 404],
    "possible_endpoints": [
      "/api/auth/*",
      "/api/user/*",
      "ì¸ì¦ì´ í•„ìš”í•œ ëª¨ë“  API"
    ]
  },

  "implementation_options": {
    "option_1_global_interceptor": {
      "description": "Axios/Fetch ì¸í„°ì…‰í„°ì—ì„œ ì „ì—­ ì²˜ë¦¬ (ê¶Œì¥)",
      "pros": ["ëª¨ë“  APIì— ì¼ê´„ ì ìš©", "ì½”ë“œ ì¤‘ë³µ ì—†ìŒ"],
      "cons": ["íŠ¹ì • APIë§Œ ì˜ˆì™¸ ì²˜ë¦¬ í•„ìš”í•  ìˆ˜ ìˆìŒ"],
      "file": "src/services/api.js ë˜ëŠ” src/utils/axiosInstance.js",
      "code_example": [
        "// Axios ì¸í„°ì…‰í„° ì˜ˆì‹œ",
        "api.interceptors.response.use(",
        "  (response) => response,",
        "  (error) => {",
        "    const message = error.response?.data?.message;",
        "    ",
        "    // ì‚¬ìš©ì ë¯¸ë°œê²¬ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸",
        "    if (message === 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.') {",
        "      // í† í° ë° ì‚¬ìš©ì ì •ë³´ ì œê±°",
        "      localStorage.removeItem('authToken');",
        "      localStorage.removeItem('user');",
        "      ",
        "      // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™",
        "      window.location.href = '/login';",
        "      return Promise.reject(error);",
        "    }",
        "    ",
        "    return Promise.reject(error);",
        "  }",
        ");"
      ]
    },
    "option_2_auth_context": {
      "description": "AuthContextì—ì„œ ì²˜ë¦¬",
      "pros": ["React ìƒíƒœê³„ ë‚´ì—ì„œ ì²˜ë¦¬", "ìƒíƒœ ê´€ë¦¬ì™€ í†µí•©"],
      "cons": ["AuthContextë¥¼ ì‚¬ìš©í•˜ëŠ” ê³³ì—ì„œë§Œ ë™ì‘"],
      "file": "src/contexts/AuthContext.js",
      "code_example": [
        "// AuthContext ë‚´ë¶€ì— í•¨ìˆ˜ ì¶”ê°€",
        "const handleApiError = useCallback((error) => {",
        "  const message = error.response?.data?.message;",
        "  ",
        "  if (message === 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.') {",
        "    logout(); // ê¸°ì¡´ logout í•¨ìˆ˜ í˜¸ì¶œ",
        "    navigate('/login', { ",
        "      state: { message: 'ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.' }",
        "    });",
        "  }",
        "}, [logout, navigate]);"
      ]
    },
    "option_3_individual_handling": {
      "description": "ê° ì»´í¬ë„ŒíŠ¸ì—ì„œ ê°œë³„ ì²˜ë¦¬",
      "pros": ["ì„¸ë°€í•œ ì œì–´ ê°€ëŠ¥"],
      "cons": ["ì½”ë“œ ì¤‘ë³µ", "ìœ ì§€ë³´ìˆ˜ ì–´ë ¤ì›€"],
      "not_recommended": true
    }
  },

  "recommended_implementation": {
    "approach": "option_1_global_interceptor",
    "reason": "ëª¨ë“  API í˜¸ì¶œì— ì¼ê´€ë˜ê²Œ ì ìš©, ìœ ì§€ë³´ìˆ˜ ìš©ì´",

    "files_to_modify": [
      {
        "file": "src/services/api.js (ë˜ëŠ” axiosInstance.js)",
        "action": "ì‘ë‹µ ì¸í„°ì…‰í„°ì— ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ì¶”ê°€"
      }
    ],

    "full_implementation": {
      "file": "src/services/api.js",
      "code": [
        "import axios from 'axios';",
        "",
        "const api = axios.create({",
        "  baseURL: process.env.REACT_APP_API_BASE_URL,",
        "  headers: {",
        "    'Content-Type': 'application/json',",
        "  },",
        "});",
        "",
        "// ìš”ì²­ ì¸í„°ì…‰í„° - í† í° ìë™ ì¶”ê°€",
        "api.interceptors.request.use((config) => {",
        "  const token = localStorage.getItem('authToken');",
        "  if (token) {",
        "    config.headers.Authorization = `Bearer ${token}`;",
        "  }",
        "  return config;",
        "});",
        "",
        "// ì‘ë‹µ ì¸í„°ì…‰í„° - ì—ëŸ¬ ì²˜ë¦¬",
        "api.interceptors.response.use(",
        "  (response) => response,",
        "  (error) => {",
        "    const message = error.response?.data?.message;",
        "    const status = error.response?.status;",
        "    ",
        "    // ì‚¬ìš©ì ë¯¸ë°œê²¬ ë˜ëŠ” ì¸ì¦ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ",
        "    if (",
        "      message === 'ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' ||",
        "      status === 401",
        "    ) {",
        "      console.log('ğŸ” ì¸ì¦ ì˜¤ë¥˜ - ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™');",
        "      ",
        "      // ì €ì¥ëœ ì¸ì¦ ì •ë³´ ì œê±°",
        "      localStorage.removeItem('authToken');",
        "      localStorage.removeItem('user');",
        "      ",
        "      // í˜„ì¬ í˜ì´ì§€ê°€ ë¡œê·¸ì¸ í˜ì´ì§€ê°€ ì•„ë‹Œ ê²½ìš°ì—ë§Œ ë¦¬ë‹¤ì´ë ‰íŠ¸",
        "      if (!window.location.pathname.includes('/login')) {",
        "        window.location.href = '/login?expired=true';",
        "      }",
        "    }",
        "    ",
        "    return Promise.reject(error);",
        "  }",
        ");",
        "",
        "export default api;"
      ]
    }
  },

  "login_page_enhancement": {
    "description": "ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œ ë§Œë£Œ ë©”ì‹œì§€ í‘œì‹œ (ì„ íƒì‚¬í•­)",
    "file": "src/pages/LoginPage/LoginPage.js",
    "code": [
      "// URL íŒŒë¼ë¯¸í„°ë¡œ ë§Œë£Œ ì—¬ë¶€ í™•ì¸",
      "const [searchParams] = useSearchParams();",
      "const isExpired = searchParams.get('expired') === 'true';",
      "",
      "// ë§Œë£Œ ë©”ì‹œì§€ í‘œì‹œ",
      "{isExpired && (",
      "  <div className={styles.expiredMessage}>",
      "    ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.",
      "  </div>",
      ")}"
    ]
  },

  "testing": [
    {
      "case": "ì¸ì¦ëœ ì‚¬ìš©ìê°€ ì‚­ì œëœ ê²½ìš°",
      "expected": "ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ìë™ ì´ë™, í† í° ì‚­ì œ"
    },
    {
      "case": "í† í° ë§Œë£Œëœ ê²½ìš°",
      "expected": "ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ìë™ ì´ë™"
    },
    {
      "case": "ì´ë¯¸ ë¡œê·¸ì¸ í˜ì´ì§€ì— ìˆëŠ” ê²½ìš°",
      "expected": "ë¦¬ë‹¤ì´ë ‰íŠ¸ ë£¨í”„ ë°©ì§€"
    }
  ],

  "notes": [
    "íšŒì›ê°€ì… í”Œë¡œìš°ì—ì„œëŠ” ì´ ì—ëŸ¬ê°€ ì •ìƒì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì˜ˆì™¸ ì²˜ë¦¬ ê³ ë ¤",
    "ë¡œê·¸ì¸ í˜ì´ì§€ ìì²´ì—ì„œ ë°œìƒí•˜ëŠ” ì—ëŸ¬ëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ì§€ ì•ŠìŒ",
    "React Routerì˜ navigate ëŒ€ì‹  window.location.href ì‚¬ìš© (ì¸í„°ì…‰í„°ì—ì„œ í›… ì‚¬ìš© ë¶ˆê°€)"
  ]
}
